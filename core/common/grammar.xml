<!-- Read all E.V.s from the database; use them to form a series of regular expressions and
match them against every provided word. If there are any hits, disassemble the word into its
components and replace it in the list with an array.

Next, read every required word from the database and store its information in an array.

Then analyse the word order to validate and parse the syntax of the sentence.
Determine where component breaks occur.

Then, lastly, render each component.

A renderList(header, words) function should be created to render sections. -->
<?php
	$word_string = implode(" ", $words);
	
	function renderWord($word){
		global $mysql;
		global $SCHOOL;
		global $SYNTAX_CLASS;
		
		$stmt = $mysql->prepare("SELECT word, meaning_english, kana, class FROM hymmnos WHERE word = ? LIMIT 1");
		$stmt->bind_param("s", $word);
		$stmt->execute();
		$stmt->store_result();
		
		echo "<tr>";
			if($stmt->num_rows > 0){
				$stmt->bind_result($r_word, $meaning_english, $kana, $class);
				$stmt->fetch();
				echo "<td class=\"word-header-$class\" style=\"width: 80px;\"><a href=\"javascript:popUp('/hymmnoserver/word.php?word=$r_word')\" style=\"color: white;\">$r_word</a></td>";
				echo "<td class=\"word-header-$class\" style=\"width: 75px;\">$SYNTAX_CLASS[$class]</td>";
				echo "<td class=\"word-header-$class\" style=\"width: 275px;\">$meaning_english</td>";
				echo "<td class=\"word-header-$class\" style=\"width: 100px;\">$kana</td>";
			}else{
				echo "<td class=\"word-header-0\" style=\"width: 80px;\">$word</td>";
				echo "<td class=\"word-header-0\" style=\"width: 75px;\">???</td>";
				echo "<td class=\"word-header-0\" style=\"width: 275px;\">???</td>";
				echo "<td class=\"word-header-0\" style=\"width: 100px;\">???</td>";
			}
		echo "</tr>";
		
		$stmt->free_result();
		$stmt->close();
	}
?>

<p>
	At present, all sentences will be reported as invalid.
	This is because there is no validity-checking code yet.
</p>
<hr/><span>This section is under development</span><hr/>
<span>
	Note: There is no difference between singular and plural nouns, unless implied by context.
	&quot;wart&quot; can mean either &quot;word&quot; or &quot;words&quot;,
	depending on which is more appropriate.
</span>
<hr/>
<table style="border-collapse: collapse; border: 1px solid black;">
	<tr>
		<td style="color: darkblue; text-align: center; background: lightgrey;" colspan="2">
			<span style="font-family: hymmnos; font-size: 28pt;">
				<?php echo $word_string; ?>
			</span>
			<br/>
			<span style="font-size: 20pt;">
				<?php echo $word_string; ?>
			</span>
		</td>
	</tr>
	<tr>
		<td style="width: 75px; background: yellow;">
			Each identified section will appear in its own row.
			This bar will indicate its grammatical type
			(Emotion Sound, Emotion Verb...)
		</td>
		<td style="width: 530px; background: grey;">
			<table style="width: 100%; color: white; font-size: 0.8em;">
				<?php
					foreach($words as $word){
						renderWord($word);
					}
				?>
			</table>
		</td>
	</tr>
	<tr>
		<td style="background: red; color: white; text-align: center;" colspan="2">
			This sentence does not appear to be valid Hymmnos<br/>
			<small>(Is this wrong? Let <a href="/hymmnoserver/credits.php" style="color: #cccccc;">someone</a> know!)</small>
		</td>
	</tr>
</table>
<br/>
